= AutoHokey Scripts
Andreas Weyer <dev@cbaoth.de>
v1.0, 2018-09-06
:toc:
:toc-placement: auto
//:sectnums:
//:sectnumlevels: 3
:source-highlighter: prettify
//:source-highlighter: highlight.js
:imagesdir: ./adoc_assets
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== link:WindowTracking.ahk[]

A script that tracks current and previous window details, like window id, class, process id, process executable and process name, in global variables, including a hotkey tooltip and clipboard functionality to be used as Windows / AutoHotkey development tool.

By Pressing `Win-F8` _(default key binding)_ the monitoring mode is activated. While aktive, a tooltip like the following will be shown and updated after each window switch:

image::windowtracking_tootlip_1.png[]

The script includes a blacklist that ignores windows like windows task-bar/-choose, desktop, the autohotkey tooltip itself and other windows that usually doesn't want to capture. These blacklisted windows are still captured, but in a separate set of variables (single last blacklisted window only).

The details of the last captured blacklisted window can additionally be shown by pressing `Win-Shift-F8` _(default key binding)_:

image::windowtracking_tootlip_2.png[]

The _(default)_ hotkeys `Win-(Shift-)F8` toggle the tooltip _(on/off)_. While monitoring is activated the tooltip will refreshes every time a new window is activated _(focus change)_.

[source,autohetkey]
----
; win-F8 -> toggle tooltip without blacklisted windows
#F8::_toggleShowTrackedWindows() ; clipboard on close, show final tt 5sec
;#F8::_toggleShowTrackedWindows(,0,0) ; no clipboard, close immediate
;#F8::_toggleShowTrackedWindows(,2) ; always clipboard (each change)

; win-shift_F8 -> toggle tooltip with blacklisted windows
#+F8::_toggleShowTrackedWindows(true) ; bl + clipboard on close, show final tt 5sec
;#+F8::_toggleShowTrackedWindows(true,0,0) ; bl + no clipboard, close immediate
;#F8::_toggleShowTrackedWindows(true,2) ; bl + always clipboard (each change)
----

Per default the tootlip content is copied to the clipboard when monitoring is stopped _(toggle off)_ and the tooltip is updated for the last time _(before closing)_. Alternatively it is also possible to continuously update the clipboard _(on every window change)_ or to not update the clipboard at all. See the code documentation of `_toggleShowTrackedWindows` and the examples above.

The clipboard text contains the same information as the tooltip but in a slightly simplified/cleaner format using `\t` as column delimiter:

[format=tsv,cols="1,3"]
|===
*ACTIVE WINDOW:*	 &nbsp;
active_id	0x831b5a
active_title	README.adoc - dotfiles - Visual Studio Code
active_class	Chrome_WidgetWin_1
active_pid	343836
active_procname	Code.exe
*PREVIOUS WINDOW:*	&nbsp;
previous_id	0xd61bb4
previous_title	AutoHotkey Community - Index page - Firefox Developer Edition
previous_class	MozillaWindowClass
previous_pid	172388
previous_procname	firefox.exe
|===

== Games

Some game specific hotkeys and functions.

=== link:PathOfExile.ahk[]

Requires functions from link:Commons.ahk[]

[cols="1,3",options="header"]
|===
Key|Function|
``` _(hyphon)_ | Panik button. Use all flasks in random order with random intermittend delay.|
`ctrl-h` | Enter the hideout _(if possible, e.g. from cities/camps)_.|
|===

=== link:Skyrim.ahk[]

[cols="1,3",options="header"]
|===
Key|Function|
`Win-[` | Load *Riften Honeyside* house using console command _(cheat, no official fast travel)_|
`Win-]` | Load *Riften Thieves Guild Headquarters* using console command _(cheat, no official fast travel)_|
|===

=== link:Divinity.ahk[]: Original Sin

_Todo ..._
